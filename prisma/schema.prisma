generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fullTextSearch"]
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Users {
  idUser    String     @id @default(uuid())
  name      String
  lastName  String
  email     String     @unique
  password  String
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  status    USERSTATUS @default(ACTIVE)
  servers   Servers[]
}

model Servers {
  idServer     String         @id @default(uuid())
  url          String
  ip           String
  description  String
  title        String
  status       SERVERSTATUS   @default(ACTIVE)
  workerType   WORKERTYPE
  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  Users        Users?         @relation(fields: [idUser], references: [idUser])
  idUser       String?
  TasksServers TasksServers[]
  Ping         Pings[]
}

model Tasks {
  idTask       String         @id @default(uuid())
  log          String
  type         TASKTYPES      @default(UNDEFINED)
  interval     BigInt
  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  TasksServers TasksServers[]
}

model TasksServers {
  id             String  @id @default(uuid())
  idServer       Servers @relation(fields: [serverIdServer], references: [idServer])
  idTask         Tasks   @relation(fields: [taskIdTask], references: [idTask])
  taskIdTask     String
  serverIdServer String
}

model Pings {
  idPing          String   @id @default(uuid())
  times           Float
  packetLoss      Float
  min             Float
  max             Float
  avg             Float
  log             String
  isAlive         Boolean
  numericHost     String
  createdAt       DateTime @default(now())
  Servers         Servers? @relation(fields: [serversIdServer], references: [idServer])
  serversIdServer String?
}

enum SERVERSTATUS {
  ACTIVE
  INACTIVE
}

enum USERSTATUS {
  ACTIVE
  INACTIVE
}

enum TASKSSTATUS {
  RUNNING
  STOPPED
  DELETED
  WAITING
}

enum WORKERTYPE {
  SERVER
  URL
}

enum TASKTYPES {
  UNDEFINED
  SERVER
  BACKGROUND
  SUMMARY
  ADMIN
  DAILY
}
